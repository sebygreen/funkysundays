version: "3.7"
name: funkysundays
services:
    backend:
        build:
            context: ./backend
            dockerfile: Dockerfile
        container_name: backend
        restart: unless-stopped
        volumes:
            - ./pb_data:/pb_data
            - ./pb_migrations:/pb_migrations
        networks:
            - funkysundays
    frontend:
        depends_on:
            - backend
        build:
            context: ./frontend
            dockerfile: Dockerfile
        container_name: frontend
        restart: unless-stopped
        networks:
            - funkysundays
        labels:
            - "traefik.enable=true"
            - "traefik.http.routers.funkysundays.rule=Host(`funkysundays.smkg.me`)"
            - "traefik.http.routers.funkysundays.entrypoints=websecure"
            - "traefik.http.routers.funkysundays.tls.certresolver=letsencrypt"
networks:
    funkysundays:
        external: true
    traefik_proxy:
        external: true
